---
import CallToAction from './CallToAction.astro'
import Logo from './Logo.astro'
import { Heading, Link } from 'accessible-astro-components'

/**
 * Footer Component
 *
 * @description A component that displays the footer of the website (Client-side rendered)
 */

const currentYear = new Date().getFullYear()
---

<footer>
  <CallToAction />
  <section class="py-20">
    <Heading level="h2" class="sr-only">页脚</Heading>
    <div class="container grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-4">
      <div class="flex flex-col gap-4">
        <Heading level="h3" size="h6">快速链接</Heading>
        <ul class="flex flex-col gap-2">
          <li><Link href="/">首页</Link></li>
          <li><Link href="/portfolio">案例展示</Link></li>
          <li><Link href="/blog">资讯中心</Link></li>
          <li><Link href="/contact">联系我们</Link></li>
        </ul>
      </div>
      <div class="flex flex-col gap-4">
        <Heading level="h3" size="h6">服务项目</Heading>
        <ul class="flex flex-col gap-2">
          <li><Link href="/portfolio">企业官网建设</Link></li>
          <li><Link href="/portfolio">业务系统开发</Link></li>
          <li><Link href="/portfolio">小程序开发</Link></li>
          <li><Link href="/portfolio">可访问性优化</Link></li>
        </ul>
      </div>
      <div class="flex flex-col gap-4">
        <Heading level="h3" size="h6">联系我们</Heading>
        <ul class="flex flex-col gap-2">
          <li>
            <Link href="mailto:contact@company.com">contact@company.com</Link>
          </li>
          <li>
            <Link href="tel:+861234567890">+86 123 4567 890</Link>
          </li>
          <li class="mt-2">
            <address class="not-italic">
              北京市朝阳区<br />
              示例大厦100号 5层
            </address>
          </li>
        </ul>
      </div>
      <div class="flex flex-col gap-4">
        <Logo loading="lazy" />
        <p id="company-description" class="text-sm leading-[1.75]">
          专注企业数字化与高质量交付，助力品牌增长与业务转化。
        </p>
        <div class="flex flex-col gap-2 text-sm">
          <Link href="/accessibility-statement">无障碍声明</Link>
          <Link href="/sitemap">站点地图</Link>
        </div>
      </div>
    </div>
  </section>
  <section class="py-8">
    <div class="container flex flex-col gap-4 md:flex-row md:justify-between">
      <div id="footer-info" class="flex flex-col gap-2 text-sm">
        <p>© {currentYear} 示例科技有限公司。保留所有权利。</p>
      </div>
      <p class="text-sm">
        用心打造 · <Link href="/">示例科技团队</Link>
      </p>
    </div>
  </section>
</footer>

<script>
  import { getSiteConfig } from '@utils/clientApi'

  async function loadSiteConfig() {
    try {
      const response = await getSiteConfig()
      const config = response.data

      // 更新公司描述
      const descriptionEl = document.getElementById('company-description')
      if (descriptionEl && config.company_description) {
        descriptionEl.textContent = config.company_description
      }

      // 更新页脚信息
      const footerInfoEl = document.getElementById('footer-info')
      if (footerInfoEl) {
        const currentYear = new Date().getFullYear()
        const companyName = config.company_name || '示例科技有限公司'
        const copyrightInfo = config.copyright_info || `© ${currentYear} ${companyName}。保留所有权利。`
        
        let html = `<p>${copyrightInfo}</p>`
        
        if (config.icp_number) {
          html += `<p>备案号：${config.icp_number}</p>`
        }
        
        if (config.police_number) {
          html += `<p>公安备案：${config.police_number}</p>`
        }
        
        footerInfoEl.innerHTML = html
      }
    } catch (error) {
      console.error('Failed to load site config:', error)
      // 失败时使用默认值，不影响页面显示
    }
  }

  // 页面加载完成后获取配置
  loadSiteConfig()
</script>

<style>
  section {
    border-top: 1px solid var(--border-color-subtle);
  }
</style>
